{% extends 'secundarios/base.html' %}
{% load static %}
{% block title %}Mapa{% endblock %}
{% block extra_head %}
    <!-- usar CDN do Leaflet para garantir o CSS -->
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

    <style>
        #map { width: 100%; height: 72vh; border: 1px solid #ddd; border-radius:6px; }
        .search-bar { display:flex; gap:8px; margin-bottom:10px; align-items:center; }
        .search-bar input[type="search"] { flex:1; padding:8px 10px; border-radius:4px; border:1px solid #ccc; box-sizing: border-box; }
        .search-bar button { padding:8px 12px; border-radius:4px; background:#0d6efd; color:#fff; border:none; cursor:pointer; }
        /* lista de resultados abaixo do mapa ficará oculta — informações só aparecem ao clicar no marcador */
        .results { display:none; }
        .result-item { padding:6px; border-bottom:1px solid #eee; cursor:pointer; display:flex; justify-content:space-between; align-items:center; gap:8px; }
        .result-item:hover { background:#f7f7f7; }
        .result-left { flex: 1; }
        .result-actions a { text-decoration: none; color: #0d6efd; font-size:0.9rem; }
        .info { color:#666; margin-top:6px; font-size:0.9rem; }
        .access-open { color: #127a13; font-weight:600; }
        .access-closed { color: #b02a37; font-weight:600; }
        .access-unknown { color: #6c757d; font-weight:600; }
    </style>
{% endblock %}
{% block content %}
        <h1>Procure quadras públicas</h1>

        <div class="search-bar" role="search" aria-label="Busca de quadras">
            <input id="query" type="search" placeholder="Ex.: quadras de tênis, futsal perto de mim, quadras públicas" />
            <button id="searchBtn">Pesquisar</button>
            <button id="clearBtn" title="Limpar resultados" style="background:#6c757d">Limpar</button>
        </div>
        <div class="info">Dica: posicione o mapa na área desejada antes de pesquisar — a busca usa os limites visíveis.</div>
        <div id="map" aria-label="Mapa do Brasil interativo"></div>
        <div class="results" id="results"></div> <!-- mantido oculto para compatibilidade -->
    <footer>Busca via Overpass API (OpenStreetMap). Resultados públicos.</footer>
{% endblock %}
{% block extra_js %}
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="{% static 'secundarios/js/mapa.js' %}?v=123"></script>
{% endblock %}